{"version":3,"sources":["court-admin.js"],"names":["moj","Modules","Helpers","Events","$","init","x","trigger","log","msg","window","console","dir","obj","devs","m","txt","FocusHandler","$firstAlert","eq","this","addTabIndex","focus","on","$target","attr","find","setTimeout","$el","tabIndex","undefined","PromptOnChange","prototype","message","sessionTimeout","promptOnChangeMessage","currentHash","hashFields","bindEvents","enable","self","disable","runCheck","serialize","fieldsHaveChanged","isSessionTimeoutRedirect","isEnabled","now","Math","floor","Date","getTime","_PromptOnChange","SelectionButtons","change","is","closest","removeClass","addClass","blur","jQuery","fx","off","location","href","val"],"mappings":"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","file":"court-admin.js","sourcesContent":["(function(){\n  'use strict';\n\n  var moj = {\n\n    Modules: {},\n\n    Helpers: {},\n\n    Events: $({}),\n\n    init: function () {\n      for (var x in moj.Modules) {\n        if (typeof moj.Modules[x].init === 'function') {\n          moj.Modules[x].init();\n        }\n      }\n      // trigger initial render event\n      moj.Events.trigger('render');\n    },\n\n    // safe logging\n    log: function (msg) {\n      if (window && window.console) {\n        window.console.log(msg);\n      }\n    },\n    dir: function (obj) {\n      if (window && window.console) {\n        window.console.dir(obj);\n      }\n    }\n\n  };\n\n  window.moj = moj;\n}());\n\n(function () {\n  'use strict';\n\n  // Invite interested developers to join us\n  moj.Modules.devs = {\n    init: function () {\n      var m = '      ___          ___       ___\\n     /__/\\\\        /  /\\\\     /  /\\\\\\n    |  |::\\\\      /  /::\\\\   /  /:/\\n    |  |:|:\\\\    /  /:/\\\\:\\\\ /__/::\\\\\\n  __|__|:|\\\\:\\\\  /  /:/  \\\\:\\\\\\\\__\\\\/\\\\:\\\\\\n /__/::::| \\\\:\\\\/__/:/ \\\\__\\\\:\\\\  \\\\  \\\\:\\\\\\n \\\\  \\\\:\\\\~~\\\\__\\\\/\\\\  \\\\:\\\\ /  /:/   \\\\__\\\\:\\\\\\n  \\\\  \\\\:\\\\       \\\\  \\\\:\\\\  /:/    /  /:/\\n   \\\\  \\\\:\\\\       \\\\  \\\\:\\\\/:/    /__/:/\\n    \\\\  \\\\:\\\\       \\\\  \\\\::/     \\\\__\\\\/\\n     \\\\__\\\\/        \\\\__\\\\/',\n      txt = '\\n\\nLike what you see? Want to make a difference?'+\n            '\\n\\nFind out how we\\'re making the Ministry Of Justice Digital by Default.'+\n            '\\nhttps://mojdigital.blog.gov.uk/.'+\n            '\\n\\nGet in touch to see what positions are available and see what projects you could be working on.'+\n            '\\nhttps://mojdigital.blog.gov.uk/working-at-moj-ds/';\n      moj.log(m+txt);\n    }\n  };\n}());\n\n/**\n * Handle several aspects of focusing on the relevant element\n */\n(function() {\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  moj.Modules.FocusHandler = {\n    init: function() {\n      var $firstAlert = $('.success-header, .error-summary').eq(0);\n\n      /**\n       * Set focus to the first alert or success on the page\n       */\n      this.addTabIndex($firstAlert, '0');\n      $firstAlert.focus();\n\n      /**\n       * Set focus to the main content when clicking the 'skip link'\n       */\n      this.addTabIndex($('#content'), '-1');\n      $('.skiplink').on('click', function() { $('#content').focus(); });\n\n      /**\n       * Set focus to the relevant field when clicking an error message in the summary\n       */\n      $('.error-summary [href^=#section_]').on('click', function() {\n        var $target = $($(this).attr('href')).find('input, textarea, select').eq(0);\n        setTimeout(function() { $target.focus(); }, 250);\n      });\n    },\n    addTabIndex: function($el, tabIndex) {\n      if ($el.attr('tabindex') === undefined) {\n        $el.attr('tabindex', tabIndex);\n      }\n    }\n  };\n}());\n\n/**\n * Page exit prompt\n *\n * Prompts the user upon leaving the page if they have changed\n * any data in any form.\n *\n * To set an alternative message or a session timeout timestamp\n * (after which the prompt will be disabled), declare the following\n * variables somewhere in the markup:\n *\n * <script>\n *   var promptOnChangeMessage = \"Alternative message\";\n *   var sessionTimeout = 123456789;\n * </script>\n */\n\n(function(){\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var PromptOnChange = function() {\n    this.init();\n    return this;\n  };\n\n  PromptOnChange.prototype = {\n    init: function() {\n      this.message = \"You have entered some information\";\n      this.sessionTimeout = false;\n\n      if (typeof promptOnChangeMessage === 'string') {\n        this.message = promptOnChangeMessage;\n      }\n      if (typeof sessionTimeout === 'number') {\n        this.sessionTimeout = sessionTimeout;\n      }\n\n      this.currentHash = this.hashFields();\n      this.bindEvents();\n\n      this.enable();\n    },\n\n    bindEvents: function() {\n      var self = this;\n\n      $('form').on('submit', function() {\n        self.disable();\n      });\n\n      // The second event here is used for testing, as there is no\n      // other way of mocking a beforeunload event!\n      $(window).on('beforeunload mock.beforeunload', function() {\n        return self.runCheck();\n      });\n    },\n\n    hashFields: function() {\n      return $('form').serialize();\n    },\n\n    fieldsHaveChanged: function() {\n      return this.hashFields() !== this.currentHash;\n    },\n\n    runCheck: function() {\n      if (this.isSessionTimeoutRedirect()) {\n        this.disable();\n      }\n\n      if (this.isEnabled && this.fieldsHaveChanged()) {\n        return this.message;\n      }\n    },\n\n    enable: function() {\n      this.isEnabled = true;\n    },\n\n    disable: function() {\n      this.isEnabled = false;\n    },\n\n    isSessionTimeoutRedirect: function() {\n      if (this.sessionTimeout) {\n        var now = Math.floor(new Date().getTime() / 1000);\n\n        if (now >= this.sessionTimeout) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n  };\n\n  moj.Modules._PromptOnChange = PromptOnChange;\n\n  moj.Modules.PromptOnChange = {\n    init: function() {\n      return new PromptOnChange();\n    }\n  };\n\n}());\n\n/**\n * Selection Buttons\n *\n * Provides extra focused and selected classes to radio and checkbox\n * form inputs to bring them to default gov.uk styling\n */\n\n(function() {\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  moj.Modules.SelectionButtons = {\n    init: function() {\n\n      $('label input[type=radio], label input[type=checkbox]').on({\n        'change': function(){\n          if ($(this).is(':checked')) {\n            if ($(this).is(':radio')) {\n              $(this).closest('form').find('[name=\"' + $(this).attr('name') + '\"]').closest('label').removeClass('selected');\n            }\n            $(this).closest('label').addClass('selected');\n          }\n          else {\n            $(this).closest('label').removeClass('selected');\n          }\n        },\n        'focus': function() {\n          $(this).closest('label').addClass('focused');\n        },\n        'blur': function() {\n          $(this).closest('label').removeClass('focused');\n        }\n      }).trigger('change');\n\n    }\n  };\n\n}());\n\n\n$(function() {\n  jQuery.fx.off = true;\n\n  $('[data-auto-refresh]').on('change', function() {\n    window.location.href = $(this).val();\n  });\n\n  moj.init();\n});\n"],"sourceRoot":"/source/"}